# pentest-file-uploader
A Python script for testing file upload vulnerabilities in web applications, showcasing skills in web penetration testing, Python scripting, error handling, and command-line interface design.


# File Upload Script for Pentesting

This script is designed for penetration testers to automate the process of uploading files to a web server with various PHP extensions. It helps in identifying potential file upload vulnerabilities in web applications.

**Note:** To use this script, make sure you have the `cmd.php` file in the directory from which you will run the script. This file will be uploaded with different PHP extensions to test vulnerabilities in the application.

## Features

- Attempts to upload a specified file with multiple common PHP extensions.
- Allows customization of the upload URL, session cookie, Burp Suite proxy, file to upload, and file extensions.
- Checks the response for success or failure based on keywords in the `Location` header.

## Requirements

- Python 3.x
- `requests` library: Install using `pip install requests`
- `termcolor` library: Install using `pip install termcolor`
-  know the location-head you can use burnd suite for this propuse
-  To use this script, make sure you have the `cmd.php` file in the directory from which you will run the script
  
## Usage

### Command Line Arguments

- `upload_url`: The URL to upload the file to.
- `session_cookie`: The PHP session cookie value.
- `--burp`: (Optional) Burp Suite proxy (default: `http://127.0.0.1:8080`).
- `--file`: (Optional) The file to upload (default: `cmd.php`).
- `--extensions`: (Optional) List of file extensions to try (default: common PHP extensions).
- `--fail`: (Optional) Keyword to check for failure in the `Location` header (default: `failed`).
- `--success`: (Optional) Keyword to check for success in the `Location` header (default: `succes`).

### Running the Script

1. Clone or download the script.
2. Ensure you have the required Python libraries installed.
3. create `cmd.php` you can put here you payload
4. Run the script with the necessary arguments. 

#### Example Command

```sh
python file_upload.py http://example.com/upload.php 0pjpcuose3j9rt9d8imi8533n --file cmd.php --fail failed --success succes
```
```
──(kali㉿kali)-[~/Desktop/pruebas/uploadfiles]
└─$ python3 file_upload.py  http://10.10.11.241:8080/upload.php 0pjpcuose3j9rt9d8imi8533n --fail /failed.php --success /success.php

[-] Failed to upload cmd.php - Status code: 302
[-] Failed to upload cmd.php6 - Status code: 302
[-] Failed to upload cmd.php7 - Status code: 302
[+] File cmd.phps uploaded successfully
[+] File cmd.pht uploaded successfully
[+] File cmd.phtm uploaded successfully
[-] Failed to upload cmd.phtml - Status code: 302
[+] File cmd.pgif uploaded successfully
[+] File cmd.shtml uploaded successfully
```


